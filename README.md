# Инструкции к заданиям

---

## Задание 1
### Инструкции по запуску
1. Данные необходимо скопировать в папку проекта, в папки "анкеты" и "контракты", чтобы получился путь `<папка проекта>/анкеты/A10003.xlsx`
2. Создать пользователя и БД в MySQL:
	- Открыть MySQL Command Line Client
	- Создать нового пользователя: `CREATE USER my_db_user;`
	- Создать новую БД: `CREATE DATABASE my_db;`
	- Предоставить пользователю привилегии на БД: `GRANT ALL PRIVILEGES ON my_db.* TO my_db_user;`
	- Обновить привилегии: `FLUSH PRIVILEGES;`
3. Установить необходимые python пакеты:

	3.1 Установка через командную строку:
	
	- Открыть командную строку
	- Перейти в папку с проектом
	- Запустить команду `pip install -r requirements.txt`
		
	3.2 Установка через Anaconda:
	
	- Запустить Anaconda Navigator
	- Перейти на вкладку "Environments"
	- В поле "Search Packages" вбить и установить поочередно пакеты `mysql-connector`, `openpyxl`, `pandas`
		
4. Запустить сам скрипт:
	- Открыть командную строку
	- Перейти в папку с проектом
	- Запустить `python task1.py`

### Ожидаемые результаты:
 - Создан пользователь "my_db_user"
 - Создана база данных "my_db"
 - Скрипт "task1.py" отработал без ошибок
 - Созданы таблицы "applications", "contracts", "education_dict", "employed_by_dict", "housing_dict", "income_type_dict", "marital_status_dict", "position_dict", "type_dict" в БД "my_db"
 - Таблица "applications" содержит 64 строки, в категориальных переменных ("employed_by", "education", "marital_status", "position", "income_type", "housing") находятся id записей, а не текстовые значения
 - Таблица "contracts" содержит 60 строк, в категориальной переменной "type" находятся id записей, а не текстовые значения
 - Таблицы "*_dict" содержат пары значений "id:value" - закодированные категориальные переменные
 
 ### Краткое описание скрипта:
 Скрипт `task1.py` создает таблицы в базе данных "my_db", загружает в них данные из Excel файлов, проверяет загруженные данные на логические ошибки и исправляет их, а также кодирует категориальные переменные числами, создавая при этом словари в БД для расшифровки.

---

## Задание 2
### Инструкции по запуску (предварительно см. задание 1)
1. Поместить файл payments.xls в папку проекта
2. Перенести скрипт `task2.py` и `task2.ipynb` в папку проекта
3. Запустить скрипт

	3.1 Открыть и запустить `task2.ipynb` через Jupyter
	
	3.2 Запустить скрипт `task2.py` через командную строку:
	
	- Открыть командную строку
	- Перейти в папку с проектом
	- Запустить `python task2.py`

### Ожидаемые результаты:
 - К созданной ранее БД добавлена третья таблица – платежи по контрактам, связанная с другими таблицами
 - Скрипт отработал без ошибок
 - Найдены моменты просрочки по правилу 90+ для каждого контракта и оформлены в таблицу
 - По выбранному пользователем горизонту риска строится таблица заемщиков с кредитами, срок которых меньше заданного горизонта, с флагом `дефолт/не дефолт` на выбранном горизонте с момента выдачи кредита
 - По выбранной пользователем характеристике из анкетных данных заемщика строятся показатели (таблица и картинка):
 	- WOE и IV, если переменная категориальная или квантилизированная
	- ВАЖНО: поскольку все переменные были квантилизированы или являются категориальными, НЕ строится ROC-кривая
 - В БД создана дополнительная таблица с информацией о моментах дефолтов
 
 ### Краткое описание скрипта:
 - Добавляет к БД таблицу платежей по контрактам
 - Запрашивает из БД таблицу платежей по контрактам и находит по ней моменты просрочки 90+ для каждого контракта
 - Позволяет пользователю задать горизонт риска и строит таблицу заемщиков на выбранном горизонте
 - Позволяет пользователю выбрать характеристику заемщика, по которой строятся показатели WOE и IV
 - Отправляет информацию о моментах дефолтов в БД в виде отдельной таблицы
 
 ---
 
## Задание 3
### Инструкции по запуску (предварительно см. задания 1 и 2)
1. Поместить скрипт `task3.py` и `task3.ipynb` в папку проекта.
2. Запустить скрипт.

	2.1 Открыть и запустить `task3.ipynb` через Jupyter.
	
	2.2 Запустить скрипт `task3.py` через командную строку:
	
	- Открыть командную строку
	- Перейти в папку с проектом
	- Запустить `python task3.py`

### Ожидаемые результаты:
- Скрипт отработал без ошибок
- Произведена группировка и квантификация значений показателей заемщиков
- По заданному набору показателей вычислен рейтинговый балл каждого заемщика – сумма произведений баллов и соответствующих весовых коэффициентов

### Краткое описание скрипта:
- загружает из БД и выводит данные о параметрах заемщиков с флагом дефолт/не дефолт на горизонте риска 1 год
- производит группировку и квантификацию значений показателей заемщика (осуществляет присвоение скоринговых баллов)
- вычисляет рейтинговый балл каждого заемщика, выводит таблицу по данным заемщиков с указанием рейтинговых баллов и изображает WOE на графиках

---

## Задание 4
### Инструкции по запуску (предварительно см. задания 1, 2 и 3)
1. Поместить `my_report.html`, скрипты `task4.py` и ` export_data` в папку проекта.
2. Установить пакет WeasyPrint: 

	- Открыть командную строку
	- Прописать `pip install WeasyPrint`
	- В случае возникновения проблем с установкой предложенным способом, см. [инструкцию по установке в документации к пакету](https://weasyprint.readthedocs.io/en/stable/install.html)
	
3. Запустить скрипт `task4.py`.

	- Открыть командную строку
	- Перейти в папку с проектом
	- Запустить `python task4.py`
	
4. После выбора объекта для экспорта, программа предлагает указать путь в директорию. Для сохранения в текущую директорию ввести `./` или же ввести свой путь в формате `C:\\Users\\Asus\\Desktop`.
5. Ввести имя экспортируемого документа или нажать Enter для сохранения с именем, заданным по умолчанию.
6. После выбора параметров, программа предложит выбрать путь для сохранения отчета. Ввести для сохранения в текущую директорию `./` или нажать `Enter`, или задать другой путь в формате `C:\\Users\\Asus\\Desktop`.
7. Ввести название отчета или нажать Enter для сохранения с именем, заданным по умолчанию.

### Ожидаемые результаты:
- Скрипт отработал без ошибок.
- Пользователю предлагается выбрать объекты для экспорта.
- Пользователю предлагается указать путь в директорию и имя файла для сохранения (также задано имя по умолчанию). Произведен экспорт выбранных объектов.
- Генерируется отчет о результатах расчетов в формате pdf. Отчет сохраняется в указанную пользователем директорию с указанным пользователем именем файла (также задано имя по умолчанию).
- Отчет содержит следующие элементы:
	- Заголовок «Отчет»
	- Текстовое описание содержания отчета
	- Подписи таблиц и графиков


### Краткое описание скрипта:
Скрипт позволяет пользователю экспортировать на жесткий диск промежуточные и/или итоговые результаты работы участков программы, написанной в рамках СЗ 2-3:
- предлагает пользователю выбрать объекты для экспорта (со связанным с объектом форматом хранения)
- предлагает пользователю указать путь в директорию и имя файла для сохранения (в т.ч. задано имя по умолчанию) и экспортирует выбранные объекты
- автоматически генерирует мини-отчет о результатах расчетов по пользовательским параметрам в формате pdf, сохраняющийся в указанную пользователем директорию с заданным пользователем именем (в т.ч. задано имя по умолчанию)

